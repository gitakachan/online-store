(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d26051aa"],{"30cc":function(e,t,o){"use strict";o.r(t);var n=o("7a23"),a=Object(n["j"])("新增優惠券"),c={class:"table table-hover"},l=Object(n["h"])("thead",null,[Object(n["h"])("tr",null,[Object(n["h"])("th",null,"名稱"),Object(n["h"])("th",null,"優惠碼"),Object(n["h"])("th",null,"折扣百分比"),Object(n["h"])("th",null,"到期日"),Object(n["h"])("th",null,"是否啟用"),Object(n["h"])("th",null,"編輯")])],-1),i={key:0,class:"text-success"},s={key:1,class:"text-muted"},u=["onClick"],d=["onClick"];function r(e,t,o,r,b,p){var h=Object(n["I"])("AddNew"),m=Object(n["I"])("CouponModal"),O=Object(n["I"])("DeleteModal"),j=Object(n["I"])("ToastList"),f=Object(n["I"])("Pagination"),g=Object(n["I"])("Loading");return Object(n["z"])(),Object(n["g"])("div",null,[Object(n["k"])(h,{onOpenModal:p.openModal},{title:Object(n["W"])((function(){return[a]})),_:1},8,["onOpenModal"]),Object(n["h"])("table",c,[l,Object(n["h"])("tbody",null,[(Object(n["z"])(!0),Object(n["g"])(n["a"],null,Object(n["G"])(b.coupons,(function(e){return Object(n["z"])(),Object(n["g"])("tr",{key:e.id},[Object(n["h"])("td",null,Object(n["L"])(e.title),1),Object(n["h"])("td",null,Object(n["L"])(e.code),1),Object(n["h"])("td",null,Object(n["L"])(e.percent)+"%",1),Object(n["h"])("td",null,Object(n["L"])(p.getFormDate(e.due_date)),1),Object(n["h"])("td",null,[e.is_enabled?(Object(n["z"])(),Object(n["g"])("span",i,"啟用")):(Object(n["z"])(),Object(n["g"])("span",s,"未啟用"))]),Object(n["h"])("td",null,[Object(n["h"])("button",{type:"button",onClick:function(t){return p.openModal(!1,e)},class:"btn btn-outline-success btn-sm m-1"}," 編輯 ",8,u),Object(n["h"])("button",{type:"button",onClick:function(t){return p.openDelModal(e)},class:"btn btn-outline-danger btn-sm m-1"}," 刪除 ",8,d)])])})),128))])]),Object(n["k"])(m,{coupon:b.tempCoupon,status:b.isNew?"新增":"編輯",onUpdateCoupon:p.updateCoupon,ref:"couponModal"},null,8,["coupon","status","onUpdateCoupon"]),Object(n["k"])(O,{onDelete:p.deleteCoupon,title:b.tempCoupon.title,id:b.tempCoupon.id,name:"優惠券",ref:"delModal"},null,8,["onDelete","title","id"]),Object(n["k"])(j),Object(n["k"])(f,{onUpdatePage:p.getCoupons,page:b.pagination},null,8,["onUpdatePage","page"]),Object(n["k"])(g,{active:b.isLoading},null,8,["active"])])}var b=o("5530"),p=(o("99af"),o("1799")),h=o("f287"),m=o("a39a"),O=o("0bdd"),j={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal","data-bs-backdrop":"static"},f={class:"modal-dialog modal-xl",role:"document"},g={class:"modal-content border-0"},v={class:"modal-header bg-dark text-white"},C={class:"modal-title",id:"exampleModalLabel"},k=["onClick"],w={class:"modal-body"},y={class:"row"},M={class:"col"},x={class:"mb-3"},D=Object(n["h"])("label",{for:"title",class:"form-label fw-bold"},"標題*",-1),_={class:"row gx-2"},L={class:"mb-3 col-md-6"},P={for:"percent",class:"form-label fw-bold"},V={class:"mb-3 col-md-6"},U=Object(n["h"])("label",{for:"code",class:"form-label fw-bold"},"優惠碼*",-1),I={class:"row"},N={class:"mb-3 col-md-6"},F=Object(n["h"])("label",{for:"date",class:"form-label fw-bold"},"到期日*",-1),z=["value"],S={class:"mb-3 col-md-6"},$={class:"form-check"},q=Object(n["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),A={class:"modal-footer"},B=["onClick"],J=["onClick","disabled"];function E(e,t,o,a,c,l){var i=Object(n["I"])("Field"),s=Object(n["I"])("error-message"),u=Object(n["I"])("v-date-picker"),d=Object(n["I"])("Form");return Object(n["z"])(),Object(n["g"])("div",null,[Object(n["h"])("div",j,[Object(n["k"])(d,null,{default:Object(n["W"])((function(e){var a=e.errors,d=e.validate,r=e.resetForm;return[Object(n["h"])("div",f,[Object(n["h"])("div",g,[Object(n["h"])("div",v,[Object(n["h"])("h5",C,[Object(n["h"])("span",null,Object(n["L"])(o.status)+"優惠券",1)]),Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:r},null,8,k)]),Object(n["h"])("div",w,[Object(n["h"])("div",y,[Object(n["h"])("div",M,[Object(n["h"])("div",x,[D,Object(n["k"])(i,{id:"title",name:"標題",type:"text",class:Object(n["s"])(["form-control",{"is-invalid":a["標題"]}]),placeholder:"請輸入標題",rules:"required",modelValue:c.tempCoupon.title,"onUpdate:modelValue":t[0]||(t[0]=function(e){return c.tempCoupon.title=e})},null,8,["class","modelValue"]),Object(n["k"])(s,{name:"標題",class:"invalid-feedback"})]),Object(n["h"])("div",_,[Object(n["h"])("div",L,[Object(n["h"])("label",P,"折扣百分比* ("+Object(n["L"])(100-c.tempCoupon.percent)+"% off)",1),Object(n["k"])(i,{id:"percent",name:"比例",type:"number",class:Object(n["s"])(["form-control",{"is-invalid":a["比例"]}]),placeholder:"請輸入折扣百分比",rules:"required|between:1,100",modelValue:c.tempCoupon.percent,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.tempCoupon.percent=e})},null,8,["class","modelValue"]),Object(n["k"])(s,{name:"比例",class:"invalid-feedback"})]),Object(n["h"])("div",V,[U,Object(n["k"])(i,{id:"code",name:"優惠碼",type:"text",class:Object(n["s"])(["form-control",{"is-invalid":a["優惠碼"]}]),placeholder:"請輸入優惠碼",rules:"required|max:10",modelValue:c.tempCoupon.code,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.tempCoupon.code=e})},null,8,["class","modelValue"]),Object(n["k"])(s,{name:"優惠碼",class:"invalid-feedback"})])]),Object(n["h"])("div",I,[Object(n["h"])("div",N,[F,Object(n["k"])(u,{modelValue:c.tempCoupon.due_date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.tempCoupon.due_date=e}),"min-date":new Date},{default:Object(n["W"])((function(e){var t=e.inputValue,o=e.inputEvents;return[Object(n["h"])("input",Object(n["q"])({class:"form-control",value:t},Object(n["M"])(o),{id:"date"}),null,16,z)]})),_:1},8,["modelValue","min-date"])]),Object(n["h"])("div",S,[Object(n["h"])("div",$,[Object(n["X"])(Object(n["h"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=function(e){return c.tempCoupon.is_enabled=e})},null,512),[[n["P"],c.tempCoupon.is_enabled]]),q])])])])])]),Object(n["h"])("div",A,[Object(n["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:r}," 取消 ",8,B),Object(n["h"])("button",{onClick:function(e){d(),l.checkStatus()},type:"button",class:"btn btn-primary",disabled:c.submitBtn}," 確認 ",8,J)])])])]})),_:1})],512)])}var W=o("db44"),T=o("62c7"),G={name:"CouponModal",mixins:[W["a"]],props:{coupon:{type:Object,required:!0},status:{type:String,required:!0}},data:function(){return{tempCoupon:{title:"",code:""},submitBtn:!1}},methods:{getUnixDate:T["b"],getFormDate:T["a"],checkStatus:function(){this.$emit("updateCoupon",this.tempCoupon)}},watch:{coupon:function(){this.tempCoupon=this.coupon,this.tempCoupon.due_date?this.tempCoupon.due_date=this.getFormDate(this.tempCoupon.due_date):this.tempCoupon.due_date=new Date,this.tempCoupon.title||(this.tempCoupon.title=""),this.tempCoupon.code||(this.tempCoupon.code=""),this.tempCoupon.is_enabled||(this.tempCoupon.is_enabled=0)},tempCoupon:{deep:!0,handler:function(){this.tempCoupon.title&&this.tempCoupon.code?this.submitBtn=!1:this.submitBtn=!0}}}};G.render=E;var H=G,X={name:"Coupons",components:{Pagination:p["a"],ToastList:h["a"],AddNew:m["a"],DeleteModal:O["a"],CouponModal:H},inject:["resMsg"],data:function(){return{coupons:[],tempCoupon:{},pagination:{},isLoading:!1,isNew:!1}},methods:{getUnixDate:T["b"],getFormDate:T["a"],openModal:function(e,t){this.tempCoupon=e?{percent:100,is_enabled:0}:Object(b["a"])({},t),this.isNew=e,this.$refs.couponModal.showModal()},openDelModal:function(e){this.$refs.delModal.showModal(),this.tempCoupon=JSON.parse(JSON.stringify(e))},getCoupons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("data-api","/admin/coupons?page=").concat(t);this.isLoading=!0,this.axios.get(o).then((function(t){t.data.success&&(e.isLoading=!1,e.coupons=t.data.coupons,e.pagination=t.data.pagination)}))},updateCoupon:function(e){var t=this;this.tempCoupon=e,this.isLoading=!0,this.tempCoupon.due_date=this.getUnixDate(this.tempCoupon.due_date);var o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("data-api","/admin/coupon"),n="post";this.isNew||(o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("data-api","/admin/coupon/").concat(e.id),n="put"),this.axios[n](o,{data:this.tempCoupon}).then((function(e){t.isLoading=!1,e.data.success&&(t.getCoupons(t.pagination.current_page),t.tempCoupon={}),t.$refs.couponModal.hideModal(),t.resMsg(e)}))},deleteCoupon:function(e){var t=this,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("data-api","/admin/coupon/").concat(e);this.isLoading=!0,this.axios.delete(o).then((function(e){e.data.success&&(t.$refs.delModal.hideModal(),t.isLoading=!1,t.getCoupons(t.pagination.current_page)),t.resMsg(e,"刪除")}))}},mounted:function(){this.getCoupons()}};X.render=r;t["default"]=X},"4de4":function(e,t,o){"use strict";var n=o("23e7"),a=o("b727").filter,c=o("1dde"),l=c("filter");n({target:"Array",proto:!0,forced:!l},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));o("b64b"),o("a4d3"),o("4de4"),o("e439"),o("159b"),o("dbb4");function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}},"62c7":function(e,t,o){"use strict";o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return a}));o("99af");function n(e){var t=new Date(1e3*e),o=t.getFullYear(),n=t.getMonth()+1;n<=9&&(n="0"+n);var a=t.getDate();return a<=9&&(a="0"+a),"".concat(o,"-").concat(n,"-").concat(a)}function a(e){return Math.floor(new Date(e)/1e3)}},a39a:function(e,t,o){"use strict";var n=o("7a23"),a={class:"text-end my-2"};function c(e,t,o,c,l,i){return Object(n["z"])(),Object(n["g"])("div",a,[Object(n["h"])("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("openModal",!0)}),class:"btn btn-primary btn-sm",type:"button"},[Object(n["H"])(e.$slots,"title")])])}var l={name:"AddNew"};l.render=c;t["a"]=l},b64b:function(e,t,o){var n=o("23e7"),a=o("7b0b"),c=o("df75"),l=o("d039"),i=l((function(){c(1)}));n({target:"Object",stat:!0,forced:i},{keys:function(e){return c(a(e))}})},dbb4:function(e,t,o){var n=o("23e7"),a=o("83ab"),c=o("56ef"),l=o("fc6a"),i=o("06cf"),s=o("8418");n({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,o,n=l(e),a=i.f,u=c(n),d={},r=0;while(u.length>r)o=a(n,t=u[r++]),void 0!==o&&s(d,t,o);return d}})},e439:function(e,t,o){var n=o("23e7"),a=o("d039"),c=o("fc6a"),l=o("06cf").f,i=o("83ab"),s=a((function(){l(1)})),u=!i||s;n({target:"Object",stat:!0,forced:u,sham:!i},{getOwnPropertyDescriptor:function(e,t){return l(c(e),t)}})}}]);
//# sourceMappingURL=chunk-d26051aa.1ea1d096.js.map